! function(e) {
    "use strict";
    e(window);
    var s, i, n, t, l, o = e("body");
    e("[data-bg-image]").each(function() {
        var s = e(this),
            i = s.data("bg-image");
        s.css("background-image", "url(" + i + ")")
    }), e(window).on("scroll", function(s) { e(window).scrollTop() + 1 > 250 ? e(".sticky-nav").addClass("menu_fixed animated fadeInDown") : e(".sticky-nav").removeClass("menu_fixed animated fadeInDown") }), e(".dropdown").on("show.bs.dropdown", function() { e(this).find(".dropdown-menu").first().stop(!0, !0).slideDown() }), e(".dropdown").on("hide.bs.dropdown", function() { e(this).find(".dropdown-menu").first().stop(!0, !0).slideUp() }), s = e(".offcanvas-toggle"), i = e(".offcanvas"), n = e(".offcanvas-overlay"), t = e(".mobile-menu-toggle"), s.on("click", function(s) {
        s.preventDefault();
        var i = e(this),
            t = i.attr("href");
        o.addClass("offcanvas-open"), e(t).addClass("offcanvas-open"), n.fadeIn(), i.parent().hasClass("mobile-menu-toggle") && i.addClass("close")
    }), e(".offcanvas-close, .offcanvas-overlay").on("click", function(e) { e.preventDefault(), o.removeClass("offcanvas-open"), i.removeClass("offcanvas-open"), n.fadeOut(), t.find("a").removeClass("close") }), (l = e(".offcanvas-menu, .overlay-menu")).find(".sub-menu").parent().prepend('<span class="menu-expand"></span>'), l.on("click", "li a, .menu-expand", function(s) {
        var i = e(this);
        ("#" === i.attr("href") || i.hasClass("menu-expand")) && (s.preventDefault(), i.siblings("ul:visible").length ? (i.parent("li").removeClass("active"), i.siblings("ul").slideUp(), i.parent("li").find("li").removeClass("active"), i.parent("li").find("ul:visible").slideUp()) : (i.parent("li").addClass("active"), i.closest("li").siblings("li").removeClass("active").find("li").removeClass("active"), i.closest("li").siblings("li").find("ul:visible").slideUp(), i.siblings("ul").slideDown()))
    });
    new Swiper(".hero-slider.swiper-container", { loop: !0, speed: 2e3, effect: "fade", autoplay: { delay: 7e3, disableOnInteraction: !1 }, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" } }), new Swiper(".tab-slider.swiper-container", { loop: !0, slidesPerView: 6, spaceBetween: 30, speed: 1500, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" }, breakpoints: { 0: { slidesPerView: 2 }, 478: { slidesPerView: 2 }, 576: { slidesPerView: 3 }, 768: { slidesPerView: 4 }, 992: { slidesPerView: 5 }, 1200: { slidesPerView: 6 } } }), new Swiper(".content-top", { slidesPerView: 2, spaceBetween: 30, speed: 1500, loop: !0, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" }, breakpoints: { 0: { slidesPerView: 1 }, 478: { slidesPerView: 1 }, 576: { slidesPerView: 1 }, 768: { slidesPerView: 2 }, 992: { slidesPerView: 2 }, 1200: { slidesPerView: 2 } } }), new Swiper(".feature-product-slider.swiper-container", { slidesPerView: 2, spaceBetween: 30, speed: 1500, loop: !0, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" }, breakpoints: { 0: { slidesPerView: 1 }, 478: { slidesPerView: 1 }, 576: { slidesPerView: 1 }, 768: { slidesPerView: 1 }, 992: { slidesPerView: 2 }, 1200: { slidesPerView: 2 } } }), new Swiper(".new-product-slider.swiper-container", { slidesPerView: 4, spaceBetween: 30, speed: 1500, loop: !0, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" }, breakpoints: { 0: { slidesPerView: 1 }, 478: { slidesPerView: 1 }, 576: { slidesPerView: 2 }, 768: { slidesPerView: 2 }, 992: { slidesPerView: 3 }, 1200: { slidesPerView: 4 } } });
    var r = new Swiper(".gallery-thumbs", { spaceBetween: 10, slidesPerView: 3, freeMode: !0, watchSlidesVisibility: !0, watchSlidesProgress: !0, centerMood: !0 }),
        a = (new Swiper(".gallery-top", { spaceBetween: 0, loop: !0, slidesPerView: 1, centerMood: !0, thumbs: { swiper: r } }), new Swiper(".zoom-thumbs", { spaceBetween: 18, slidesPerView: 3, freeMode: !0, watchSlidesVisibility: !0, watchSlidesProgress: !0, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" } })),
        p = (new Swiper(".zoom-top", { spaceBetween: 0, slidesPerView: 1, effect: "fade", fadeEffect: { crossFade: !0 }, thumbs: { swiper: a } }), a = new Swiper(".zoom-thumbs-2", { spaceBetween: 20, slidesPerView: 5, direction: "vertical", freeMode: !0, watchSlidesVisibility: !0, watchSlidesProgress: !0 }), new Swiper(".zoom-top-2", { spaceBetween: 0, loop: !0, thumbs: { swiper: a } }), r = new Swiper(".gallery-thumbs", { spaceBetween: 10, slidesPerView: 3, freeMode: !0, watchSlidesVisibility: !0, watchSlidesProgress: !0, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" } }), new Swiper(".gallery-top", { spaceBetween: 0, loop: !0, thumbs: { swiper: r } }), e(".cart-plus-minus"));
    p.prepend('<div class="dec qtybutton">-</div>'), p.append('<div class="inc qtybutton">+</div>'), e(".qtybutton").on("click", function() {
        var s = e(this),
            i = s.parent().find("input").val();
        if ("+" === s.text()) var n = parseFloat(i) + 1;
        else if (i > 1) n = parseFloat(i) - 1;
        else n = 1;
        s.parent().find("input").val(n)
    });
    new Swiper(".single-product-slider", { slidesPerView: 4, spaceBetween: 20, speed: 1500, loop: !0, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" }, breakpoints: { 0: { slidesPerView: 1 }, 478: { slidesPerView: 1 }, 576: { slidesPerView: 2 }, 768: { slidesPerView: 3 }, 992: { slidesPerView: 3 }, 1024: { slidesPerView: 4 }, 1200: { slidesPerView: 4 } } });
    e(".checkout-toggle2").on("click", function() { e(".open-toggle2").slideToggle(1e3) }), e(".checkout-toggle").on("click", function() { e(".open-toggle").slideToggle(1e3) }), e.scrollUp({ scrollText: '<i class="pe-7s-angle-up"></i>', easingType: "linear", scrollSpeed: 900, animation: "fade" }), e("[data-countdown]").each(function() {
        var s = e(this),
            i = e(this).data("countdown");
        s.countdown(i, function(e) { s.html(e.strftime('<span class="cdown hour"><span class="cdown-1">%-H</span><p>Hrs</p></span> <span class="cdown minutes"><span class="cdown-1">%M</span> <p>Min</p></span> <span class="cdown second"><span class="cdown-1"> %S</span> <p>Sec</p></span>')) })
    });
    new Swiper(".blog-post-media.swiper-container", { slidesPerView: 1, spaceBetween: 0, loop: !0, autoplay: { delay: 2e3, disableOnInteraction: !1 }, navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" } }), new Swiper(".brand-slider.swiper-container", { slidesPerView: 4, speed: 1500, loop: !0, autoplay: { delay: 2e3, disableOnInteraction: !1 }, breakpoints: { 0: { slidesPerView: 1 }, 480: { slidesPerView: 2 }, 768: { slidesPerView: 2 }, 992: { slidesPerView: 3 }, 1200: { slidesPerView: 4 } } });
    e(".venobox").venobox()
}(jQuery);


const app = angular.module("admin", []);
var host_NhaThanh = "http://localhost:8080";
const formData = new FormData();
var fileName;
var listImages = [];
var listImagesRemove = [];
var mainNameImage = '';
const timeElapsed = Date.now();

let uniqueId = Date.now().toString(36) + Math.random().toString(36).substring(2);

var ii = 100;

function progress() {
    if (ii == 100) {
        $("#noti").show(300);
        var width = 90;
        var id = setInterval(frame, 25);

        function frame() {
            if (width <= 0) {
                clearInterval(id);
                $("#noti").hide(300);
                ii = 100;
                id.clearInterval();
            } else {
                width--;
            }
        }

    }
}

function changeTab() {
    $("#ProductManagement").removeClass("show active")
    $("#account-details").addClass("show active");

    $("#product").removeClass("active")
    $("#productEdit").addClass("active");
}
//Remove div
function remove(value) {
    $(value).parent(".a-color").remove();
}
//Remove all colors
function removeColorsOnForm() {
    const elements = document.getElementsByClassName("a-color");
    while (elements.length > 0) {
        elements[0].parentNode.removeChild(elements[0]);
    }
}

function removeImage(element, index) {
    element.remove();
    listImages.splice(index, 1);
    console.log(listImages);
}
//Method add new color product
function newColor() {
    var input = document.createElement("input");
    var div = document.createElement("div");
    var button = document.createElement("button");
    button.innerText = "Remove";
    div.className = "a-color";
    div.appendChild(button);
    div.appendChild(input);
    input.setAttribute('type', 'color');
    input.className = "value-color";
    button.addEventListener("click", function() {
        div.remove();
    });
    $(".more-color").append(div);
}
//Get value colors
function colorValues() {
    var colors = document.getElementsByClassName("value-color");
    var value = "";
    for (let i = 0; i < colors.length; i++) {
        value += colors[i].value + "+";
    }
    return value;
}
//Remove images
function imageRemove(dd) {
    var value = dd.src;
    var chart;
    if (value != undefined) {
        for (var i = 0; i < value.length; i++) {
            if (value.charAt(i) == 'I') {
                chart = value.substring(i, value.length);
            }
        }
        listImagesRemove.push(chart);
    }
    dd.remove();
}
// var letters = '0123456789ABCDEF';
// var color = '#';
// $(".card").css("background-color", function() {
//     var color = '#'; // <-----------
//     for (var i = 0; i < 6; i++) {
//         color += letters[Math.floor(Math.random() * 16)];
//     }
//     return color;
// });



app.controller("admin-controller", function($scope, $http) {
    $scope.images = [];
    $scope.product = {};
    $scope.mainNameImage = "/File_Local/icon/no_image_300_300.jpg";
    $('#gallery-photo-add').change(function(event) {
        var tmppath = URL.createObjectURL(event.target.files[0]);
        fileName = event.target.files[0];
        listImages.push(fileName);
        var img = document.createElement("img");
        //Set properties 

        img.src = tmppath;
        //End set properties
        //Get index value in Array listImage
        let index = listImages.indexOf(fileName);
        //Add event for tag img
        img.addEventListener('click', () => {
            removeImage(img, index);
        });
        $(".sub-img").append(img);
        console.log(listImages);
    });

    $('#main-image').change(function(event) {
        var tmppath = URL.createObjectURL(event.target.files[0]);
        mainNameImage = event.target.files[0];
        $('#main-img').attr('src', tmppath);
        console.log(mainNameImage);
    });


    $scope.add = function() {
        formData.delete("listImages[]");
        for (var i = 0; i < listImages.length; i++) {
            formData.append('listImages[]', listImages[i]);
        }
        $http.post(`${host_NhaThanh}/uploadObject`, formData, {
            transformRequest: angular.identity,
            headers: {
                'Content-type': undefined
            }
        }).then(resp => {
            try {
                var data = resp.data;
                alert(data);
            } catch (error) {

            }
        }).catch(error => {
            console.log(error);
        })
    }
    $scope.dataProducts = function() {
        $scope.today = new Date(timeElapsed);
        //Display categories
        $http.get(`${host_NhaThanh}/getAll/categories`).then(resp => {
            $scope.cate = resp.data;
        });
        //Load country
        $http.get("File_Local/JSON/country.json").then(function(d) {
            $scope.country = d.data;
        });
        //Load all products
        $http.get(`${host_NhaThanh}/getAll/products`).then(resp => {
            $scope.products = resp.data;
            console.log($scope.products);
        }).catch(error => {
            console.log(error);
        })
    };
    $scope.uploadImage = function(nameFolder) {
        formData.delete("listImages[]");
        formData.delete("nameFloder");
        formData.delete("main-img");
        formData.append("nameFloder", nameFolder);
        formData.append("main-img", mainNameImage);
        for (var i = 0; i < listImages.length; i++) {
            formData.append('listImages[]', listImages[i]);
        }
        $http.post(`${host_NhaThanh}/uploadImages`, formData, {
            transformRequest: angular.identity,
            headers: {
                'Content-type': undefined
            }
        }).then(resp => {
            console.log(resp.data);
        });
    }
    $scope.product.available = true;
    $scope.createProduct = function() {
        //Add new product
        $scope.product.createdate = $scope.today;
        $scope.product.color = colorValues();
        $scope.product.image = uniqueId;
        $scope.product.available = true;
        $http.post(`${host_NhaThanh}/create/product`, $scope.product).then(resp => {
            if (resp.data.id != null) {
                $scope.product = {};
                alert("Add new product successfully!");
            }
            //Add image
            $scope.uploadImage(resp.data.image);
        });
    }
    $scope.refeshFormData = function() {
        formData.delete("main-img");
        formData.delete("nameFloder");
        formData.append("nameFloder", $scope.product.image);
        formData.append("main-img", mainNameImage);
    }
    $scope.updateProduct = function() {
            //Refesh color form
            $scope.product.color = colorValues();
            removeColorsOnForm();
            $http.put(`${host_NhaThanh}/update/product`, $scope.product).then(resp => {
                alert("Update " + resp.data.name + " successfully!");
                $scope.dataProducts();
            });
            //Remove old image
            if (listImagesRemove != []) {
                console.log("Remove file!");
                console.log(listImagesRemove);
                $http.post(`${host_NhaThanh}/remove/product/sub-image`, listImagesRemove).catch(error => {
                    console.log(error);
                });
            }
            if (listImages != []) {
                //Add new sub-images
                formData.delete("listImages[]");
                formData.delete("nameFloder");
                formData.append("nameFloder", $scope.product.image);
                for (var i = 0; i < listImages.length; i++) {
                    formData.append('listImages[]', listImages[i]);
                }

                $http.post(`${host_NhaThanh}/update/product/new/sub-image`, formData, {
                    transformRequest: angular.identity,
                    headers: {
                        'Content-type': undefined
                    }
                }).then(resp => {
                    console.log(resp.data);
                }).catch(eror => {
                    console.log(eror);
                });
            }
            //Update main image
            try {
                if (mainNameImage != undefined || mainNameImage != '' || mainNameImage != null) {
                    $scope.refeshFormData();
                    $http.put(`${host_NhaThanh}/update/main-image/product`, formData, {
                        transformRequest: angular.identity,
                        headers: {
                            'Content-type': undefined
                        }
                    }).then(resp => {
                        console.log(resp.data);
                    }).catch(error => {
                        console.log(error);
                    })
                }
            } catch (error) {
                console.log(error);
            }

        }
        //Method cut value colors
    $scope.cutValueColors = function(value) {
            var ds = [];
            var start = 0;
            var chart = "";
            if (value != undefined) {
                for (var i = 0; i < value.length; i++) {
                    if (value.charAt(i) == '+') {
                        chart = value.substring(start, i++);
                        ds.push(chart.trim());
                        start = i;
                    }
                }
            }
            return ds;
        }
        //Method cut value src image
    $scope.cutValuesSubImage = function(value) {
            value = value.substring(value.indexOf("File_Local"), value.length);
            return value;
        }
        //Edit product
    $scope.edit = function(value) {
            $scope.product = angular.copy(value);
            var img = [];
            changeTab();
            //Get sub image
            $http.get(`${host_NhaThanh}/getImage/subImage/${$scope.product.image}`).then(resp => {
                resp.data.forEach(element => {
                    img.push($scope.cutValuesSubImage(element));
                });
                $scope.listImages = img;
                listImages = img;
                console.log(listImages);
            }).catch(error => {
                console.log(error);
            });
            //Get main image
            $http.get(`${host_NhaThanh}/getImage/mainImage/${$scope.product.image}`).then(resp => {
                //Set value for main to update!
                mainNameImage = $scope.cutValuesSubImage(resp.data);
                $scope.mainNameImage = mainNameImage;
            }).catch(error => {
                console.log(error);
            });
        }
        //Reset form
    $scope.reset = function() {
        removeColorsOnForm();
        $scope.product = {};
        $scope.listImages = [];
        $scope.images = [];
        $scope.product = {};
        $scope.mainNameImage = "/File_Local/icon/no_image_300_300.jpg";
        $scope.product.available = true;

    }
    $scope.dataProducts();
    //Pgae product---------------------------------------------------
    $scope.pager = {
        page: 0,
        size: 4,
        get items() {
            var value;
            if ($scope.products != undefined) {
                var start = this.page * this.size;
                value = $scope.products.slice(start, start + this.size);
            }
            return value;
        },
        get count() {
            var value;
            if ($scope.products != undefined) {
                value = Math.ceil(1.0 * $scope.products.length / this.size);
            }
            return value;
        },
        first() {
            this.page = 0;
        },
        prev() {
            this.page--;
            if (this.page < 0) {
                this.last();
            }
        },
        next() {
            this.page++;
            if (this.page >= this.count) {
                this.first();
            }
        },
        last() {
            this.page = this.count - 1;
        }
    }

    //Discount -----------------------------------------------------------
    $scope.loadDataConditions = function() {
        //Product get from method dataProducts()
        //Condition
        $http.get(`${host_NhaThanh}/getAll/conditent`).then(resp => {
            if (resp.data != undefined || resp.data != null) {
                $scope.conditents = resp.data;
                console.log(resp.data);
            }
        })
    }
    $scope.loadDataConditions();
    //Create conditions
    $scope.newCondition = function() {
            $http.post(`${host_NhaThanh}/create/new_condition`, $scope.con).then(resp => {
                alert("Create new condtion for discount successfully!");
                $scope.loadDataConditions();
                $scope.con = {};
            });
        }
        //Delete condtion
    $scope.deleteCondition = function(value) {
            $http.delete(`${host_NhaThanh}/delete/condition/${value.id}`).then(resp => {
                alert("Delete condtion for discount successfully!");
                $scope.loadDataConditions();
            });
        }
        //Get all discount
    $scope.loadDataDiscount = function() {
        $http.get(`${host_NhaThanh}/getAll/discount`).then(resp => {
            if (resp.data != undefined || resp.data != null) {
                $scope.discounts = resp.data;
                console.log($scope.discounts);
            }
        });
    }
    $scope.loadDataDiscount();
    ///Discount create
    $scope.newDiscount = function() {
        $http.post(`${host_NhaThanh}/create/new_discount`, $scope.discount).then(resp => {
            alert("Create new discount successfully!");
            $scope.loadDataDiscount();
            $scope.discount = {};
        });
    }
});
app.controller("listDiscount", function($scope, $http) {
    //Get all discount
    $scope.loadDataDiscount = function() {
        $http.get(`${host_NhaThanh}/getAll/discount`).then(resp => {
            if (resp.data != undefined || resp.data != null) {
                $scope.discounts = resp.data;
                console.log($scope.discounts);
            }
        });
    };
    $scope.loadDataDiscount();
    $scope.coppy = function() {

    }
});
app.controller("BarCtrl", function($scope, $http) {
    $scope.labels = ['2006', '2007', '2008', '2009', '2010', '2011', '2012'];
    $scope.series = ['Series A', 'Series B'];

    $scope.data = [
        [65, 59, 80, 81, 56, 55, 40],
        [28, 48, 40, 19, 86, 27, 90]
    ];
});
const ctx = document.getElementById('myChart');
const line = document.getElementById('lineChart');
var labels = [];
var dataSetForm = [];


function Createchart(labels, data) {
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: data,
            datasets: [{
                label: '# Most purchased products by users',
                data: labels,
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

app.controller("report_controller", function($scope, $http) {
    $scope.dataTop5 = function() {
        $http.get(`${host_NhaThanh}/get/report/top5`).then(resp => {
            $scope.datachart = resp.data;
            console.log(resp.data);
            for (let i = 0; i < $scope.datachart.length; i++) {
                labels.push($scope.datachart[i][0]);
                dataSetForm.push($scope.datachart[i][1]);
            }
            Createchart(labels, dataSetForm);
        });
    };
    $scope.dataTop5();
});
app.controller("show-discounts", function($scope, $http) {
    $("#noti").hide();
    $scope.discountToday = function() {
        $http.get(`${host_NhaThanh}/getAll/discount/today`).then(resp => {
            $scope.today = resp.data;
            console.log(resp.data);
        })
    }
    $scope.discountToday();

    $scope.coppyVoucher = function(value) {
        // Copy the text inside the text field
        navigator.clipboard.writeText(value);
        progress();
    }
});